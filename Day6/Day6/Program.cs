
using Day6;

Console.WriteLine("Day 6: Part 1");
Part1.ejecutar();


string puzzle = "....................................#............##........#..#.#..#.........#.............#..............#.......................\r\n..................##.........#....................##.....#.......#.......................................#..........#.............\r\n.......#...........#.........................................................................................#.#.#................\r\n.#..........#...............................#....................................#...#.....#...#.#....................#....#......\r\n..........#..........................................#............#.........................#..#......#....#..#..........#........\r\n..........................................................................#..........................................#.........#..\r\n.....#....#...........................#......#..........#........................#..........#.............#...........#..........#\r\n................#.......................#...........#.............................#.....#..#..................................#...\r\n........................................................................#..#.......................................#..............\r\n........#......................#.....#.......#.............#....#.........#....#........................#.............#...........\r\n.............#....#.......#........#..#.......##................#.......................................#.........................\r\n......#..............#.#...#...............#.........................#.....#............#..#.........#...............#............\r\n..................#...#..............................................#................#.......#................#..................\r\n....#...#.............#........................#....................................#......#................#......#..............\r\n..........................................................................................#...#.........##........................\r\n.............#.#...............#.....#.#......#.............................#.......................................#.....#.......\r\n.................................................#................................................................#...............\r\n........#.#......................#......#........#.......................................................#........................\r\n....#........#......#..................................................................................#............#.............\r\n...........#.........#.......#...............#........................#........................................................#.#\r\n........................##..................#........................#..........................................#.............#...\r\n..........#........#........#.........#..................#.....#..............................#..#..............#.................\r\n#..............................................................#..#............................#..........#.......................\r\n.................................................................#...............#...#.#.........#.#.................#...........#\r\n.....................................#.....................#.....................#........#....#....#.............................\r\n#..#................#.....#....................................##............#...............#...#..........#.....................\r\n.................#.....#.....................#................#...........#...................................................#...\r\n..................................#........#.................#....#..................#.......................................#....\r\n..#....#............................#................................................##.........................................#.\r\n...............#......................................................#......##...................................................\r\n.........................#..................................#................##.#..#.#.................#.......#..................\r\n.................#......................................#...#.....................................................................\r\n.........#..........................................................................................#.......#.....................\r\n....##..#.........#..............#..#............#............#...................................#...............................\r\n......#.......................................#................................................................#..................\r\n....#..................#............................#................................................................#............\r\n...............................##.#..............#....#............#.........................................#.....#..............\r\n........#........#....#.................................................................#.....#...................#...............\r\n#...........#..#.........................................#..................................................#..##.......#.....#..#\r\n................#......#...........##..........................................................#....#.............................\r\n..........#..........#.............................................................#..............#.................#..........#..\r\n#.................#....................................................................................#..#..............#........\r\n.....#..............#.........................#.....#...........#......................#..........................................\r\n.....##.....................#...............................................................#.....................................\r\n...................#.................................................................................#.....................#..#...\r\n...............................................^......................#...........................#...............................\r\n.......#...............#.........#.........#......#.......................................................................#.......\r\n........#.........#..#..##.................................#.....#..............#...........#..#........#.........................\r\n..............................................................................#......#.#...............#..#..#.....#....#.........\r\n............#...#.......##............#....#...........................................................................#..........\r\n..................................##........#.....##.......#......................................................................\r\n.......................#...........................................#..................................#...#.........#.............\r\n............#......................................................#....#..........#...................#........................#.\r\n....................................................#......................#..........................#....#......................\r\n..................#.##....................................#..................................#.................#....#...#.........\r\n........#.....................................................................................#...#...............................\r\n....................................................#..........................................#........#..#.#.................#..\r\n....#...........#..#......#.........................#.....................#............................#.....#.#..............#...\r\n.............................#.......#..........#..................................................................#....#.....#...\r\n.....#.#................#...................#...............................................#.....................................\r\n....#........................................#......#.............................#...............................................\r\n.......#..........#........................#.....................................#..............#......#...##.....................\r\n.....#..#.............................##........................................................#.....#..............#.#..........\r\n...........................................#......#......................................#..............#.........................\r\n...................#.........#....#................#.....#.........#....................#............#..#........#...............#\r\n.....#.....................#......................................................................#...............................\r\n...............#.......................................#...#.................#..............#.....................................\r\n.........................#........................................................#...............................................\r\n..................................#..........................................#...........#.....................#..................\r\n.......................#.#............#.........................................#.................................................\r\n..........................#...................#......................#......................................#.....................\r\n.........#.........................#..............................................................#...............................\r\n..#..............................#...............#..................................###..........................................#\r\n.............................................#...............#.....#........................................................#..#..\r\n................#..........................#.......................................#........................................##.#..\r\n......##........#.....................................#............#..................#...............................#...........\r\n..#..................#......................................#....#.......................#................................#.......\r\n........................#...............#....#...#..........................................................................#.....\r\n.............#.#..........#...#....#.................##...........................................................................\r\n......#....#.......................................................................#.....................................#..#.....\r\n.............#.......#............#...#..........#...............#..................................................#..........#..\r\n..........................#...........................................................#.............#.............................\r\n#......................................#........#......#..........................................................................\r\n................#..........................................................#......................................................\r\n..................#................................................................#..........................#..........#.......#\r\n.......#.....#............##..............................................................#....................#.....#......#.....\r\n...........................................#..........#.#............................................#............................\r\n.......#.......................#..........................................................#.......................................\r\n.................#........................#.........#...#............................................................#............\r\n................................................#...................#.........#...........#...........................#...........\r\n..#..............#......#..............................##............#..................#.......#.................................\r\n.#.#.........................................#......##.....##........#.............#..#..................##....#.#...#............\r\n..#.....................#.......#....#...............#...............#...................................................#........\r\n.#...#...............#..................................................................#..........#....#.................#.#.....\r\n.#...................#...................................................................#.............#.......................#..\r\n.....................................#.....#..#...........#...........#..........#....................................#...........\r\n.................................................................................#..#.............##....#...#............#........\r\n......................#....#........#......#...................#.............................................#....................\r\n.......................................#..........................#............................#.#..........................#.....\r\n.#........................##....................................#.......#...........................#..#.......................#..\r\n.........#.........#................................................................#.................#........#..................\r\n..............#.......#.....#....................#........##.............#....#...............#.............#...........#...#.....\r\n.................................................................#..#........#...#...#.........#..................................\r\n................#......##..........#..........#.........#....#............................................#.#.............#.......\r\n...#...................................................................#.......................................#..................\r\n.......#..................#............#.....#................#..#....##.......#...............#..................................\r\n............#............##....#...................#..........................#......................................#...#...#....\r\n......#.....#..........##...............#......#...............................#......#...........................................\r\n.................#.......#.......................................................#............#........#...#.......#...........#..\r\n......................##........#...................#.....#....................#...#....#........................#................\r\n.................#.....#.......#...........#.......#....................##....................................................#.#.\r\n......#....................................#.........................#..................................#................#.#..#...\r\n..............#...........................................................................................................#.......\r\n#.#......#.................................................................................#...........#...#......................\r\n...........................................#.#........#....#............#.....................#...................................\r\n...#.............#.....................................................................................................#..........\r\n..............#..........#............#...#..............#........................................##........#.....#.......#.......\r\n..................##........#.............................................#.........................................###...........\r\n..........#......................#............................................................................#....#..............\r\n.............#........#.............#.#...............#.....#..........#.....#....#...#...........#....#..........................\r\n........#...#.......#........................#.............#..........#........#.......................#..........................\r\n..................................................................#...............#......#...#.......#............................\r\n.............#..........#...................##.............#.........#..................#.........................................\r\n.#.....#..#...#...............#.#.............#...........#.......................................................................\r\n..............#..#.........................#..............#..#..............#.......................#.#...........................\r\n............#.......................#....#................#..........#.......................#.....................#..............\r\n#.................#............................#...##....#.....#.....................................................#............\r\n.............................#........................#..................................................#....#...................\r\n.##...........................................#.....#....#....#.......................#...#.....#...#............#................\r\n........#.............#.........#..............#........................#.....................#...#...............................";
string puzzleTest = ".................#..................#............##........#..#.#..#.........#.............#..............#.......................\r\n" +
                ".................^##.........#....................##.....#.......#.......................................#..........#.............\r\n" +
                ".................#.#.........................................................................................#.#.#................\r\n.#..........#...............................#....................................#...#.....#...#.#....................#....#......\r\n..........#..........................................#............#.........................#..#......#....#..#..........#........\r\n..........................................................................#..........................................#.........#..\r\n.....#....#...........................#......#..........#........................#..........#.............#...........#..........#\r\n................#.......................#...........#.............................#.....#..#..................................#...\r\n........................................................................#..#.......................................#..............\r\n........#......................#.....#.......#.............#....#.........#....#........................#.............#...........\r\n.............#....#.......#........#..#.......##................#.......................................#.........................\r\n......#..............#.#...#...............#.........................#.....#............#..#.........#...............#............\r\n..................#...#..............................................#................#.......#................#..................\r\n....#...#.............#........................#....................................#......#................#......#..............\r\n..........................................................................................#...#.........##........................\r\n.............#.#...............#.....#.#......#.............................#.......................................#.....#.......\r\n.................................................#................................................................#...............\r\n........#.#......................#......#........#.......................................................#........................\r\n....#........#......#..................................................................................#............#.............\r\n...........#.........#.......#...............#........................#........................................................#.#\r\n........................##..................#........................#..........................................#.............#...\r\n..........#........#........#.........#..................#.....#..............................#..#..............#.................\r\n#..............................................................#..#............................#..........#.......................\r\n.................................................................#...............#...#.#.........#.#.................#...........#\r\n.....................................#.....................#.....................#........#....#....#.............................\r\n#..#................#.....#....................................##............#...............#...#..........#.....................\r\n.................#.....#.....................#................#...........#...................................................#...\r\n..................................#........#.................#....#..................#.......................................#....\r\n..#....#............................#................................................##.........................................#.\r\n...............#......................................................#......##...................................................\r\n.........................#..................................#................##.#..#.#.................#.......#..................\r\n.................#......................................#...#.....................................................................\r\n.........#..........................................................................................#.......#.....................\r\n....##..#.........#..............#..#............#............#...................................#...............................\r\n......#.......................................#................................................................#..................\r\n....#..................#............................#................................................................#............\r\n...............................##.#..............#....#............#.........................................#.....#..............\r\n........#........#....#.................................................................#.....#...................#...............\r\n#...........#..#.........................................#..................................................#..##.......#.....#..#\r\n................#......#...........##..........................................................#....#.............................\r\n..........#..........#.............................................................#..............#.................#..........#..\r\n#.................#....................................................................................#..#..............#........\r\n.....#..............#.........................#.....#...........#......................#..........................................\r\n.....##.....................#...............................................................#.....................................\r\n...................#.................................................................................#.....................#..#...\r\n......................................................................#...........................#...............................\r\n.......#...............#.........#.........#......#.......................................................................#.......\r\n........#.........#..#..##.................................#.....#..............#...........#..#........#.........................\r\n..............................................................................#......#.#...............#..#..#.....#....#.........\r\n............#...#.......##............#....#...........................................................................#..........\r\n..................................##........#.....##.......#......................................................................\r\n.......................#...........................................#..................................#...#.........#.............\r\n............#......................................................#....#..........#...................#........................#.\r\n....................................................#......................#..........................#....#......................\r\n..................#.##....................................#..................................#.................#....#...#.........\r\n........#.....................................................................................#...#...............................\r\n....................................................#..........................................#........#..#.#.................#..\r\n....#...........#..#......#.........................#.....................#............................#.....#.#..............#...\r\n.............................#.......#..........#..................................................................#....#.....#...\r\n.....#.#................#...................#...............................................#.....................................\r\n....#........................................#......#.............................#...............................................\r\n.......#..........#........................#.....................................#..............#......#...##.....................\r\n.....#..#.............................##........................................................#.....#..............#.#..........\r\n...........................................#......#......................................#..............#.........................\r\n...................#.........#....#................#.....#.........#....................#............#..#........#...............#\r\n.....#.....................#......................................................................#...............................\r\n...............#.......................................#...#.................#..............#.....................................\r\n.........................#........................................................#...............................................\r\n..................................#..........................................#...........#.....................#..................\r\n.......................#.#............#.........................................#.................................................\r\n..........................#...................#......................#......................................#.....................\r\n.........#.........................#..............................................................#...............................\r\n..#..............................#...............#..................................###..........................................#\r\n.............................................#...............#.....#........................................................#..#..\r\n................#..........................#.......................................#........................................##.#..\r\n......##........#.....................................#............#..................#...............................#...........\r\n..#..................#......................................#....#.......................#................................#.......\r\n........................#...............#....#...#..........................................................................#.....\r\n.............#.#..........#...#....#.................##...........................................................................\r\n......#....#.......................................................................#.....................................#..#.....\r\n.............#.......#............#...#..........#...............#..................................................#..........#..\r\n..........................#...........................................................#.............#.............................\r\n#......................................#........#......#..........................................................................\r\n................#..........................................................#......................................................\r\n..................#................................................................#..........................#..........#.......#\r\n.......#.....#............##..............................................................#....................#.....#......#.....\r\n...........................................#..........#.#............................................#............................\r\n.......#.......................#..........................................................#.......................................\r\n.................#........................#.........#...#............................................................#............\r\n................................................#...................#.........#...........#...........................#...........\r\n..#..............#......#..............................##............#..................#.......#.................................\r\n.#.#.........................................#......##.....##........#.............#..#..................##....#.#...#............\r\n..#.....................#.......#....#...............#...............#...................................................#........\r\n.#...#...............#..................................................................#..........#....#.................#.#.....\r\n.#...................#...................................................................#.............#.......................#..\r\n.....................................#.....#..#...........#...........#..........#....................................#...........\r\n.................................................................................#..#.............##....#...#............#........\r\n......................#....#........#......#...................#.............................................#....................\r\n.......................................#..........................#............................#.#..........................#.....\r\n.#........................##....................................#.......#...........................#..#.......................#..\r\n.........#.........#................................................................#.................#........#..................\r\n..............#.......#.....#....................#........##.............#....#...............#.............#...........#...#.....\r\n.................................................................#..#........#...#...#.........#..................................\r\n................#......##..........#..........#.........#....#............................................#.#.............#.......\r\n...#...................................................................#.......................................#..................\r\n.......#..................#............#.....#................#..#....##.......#...............#..................................\r\n............#............##....#...................#..........................#......................................#...#...#....\r\n......#.....#..........##...............#......#...............................#......#...........................................\r\n.................#.......#.......................................................#............#........#...#.......#...........#..\r\n......................##........#...................#.....#....................#...#....#........................#................\r\n.................#.....#.......#...........#.......#....................##....................................................#.#.\r\n......#....................................#.........................#..................................#................#.#..#...\r\n..............#...........................................................................................................#.......\r\n#.#......#.................................................................................#...........#...#......................\r\n...........................................#.#........#....#............#.....................#...................................\r\n...#.............#.....................................................................................................#..........\r\n..............#..........#............#...#..............#........................................##........#.....#.......#.......\r\n..................##........#.............................................#.........................................###...........\r\n..........#......................#............................................................................#....#..............\r\n.............#........#.............#.#...............#.....#..........#.....#....#...#...........#....#..........................\r\n........#...#.......#........................#.............#..........#........#.......................#..........................\r\n..................................................................#...............#......#...#.......#............................\r\n.............#..........#...................##.............#.........#..................#.........................................\r\n.#.....#..#...#...............#.#.............#...........#.......................................................................\r\n..............#..#.........................#..............#..#..............#.......................#.#...........................\r\n............#.......................#....#................#..........#.......................#.....................#..............\r\n#.................#............................#...##....#.....#.....................................................#............\r\n.............................#........................#..................................................#....#...................\r\n.##...........................................#.....#....#....#.......................#...#.....#...#............#................\r\n........#.............#.........#..............#........................#.....................#...#...............................";
//string puzzle = "....#.....\r\n.........#\r\n..........\r\n..#.......\r\n.......#..\r\n..........\r\n.#..^.....\r\n........#.\r\n#.........\r\n......#...";

//Guarda
//Posicion actual
int[] startingPosition = new int[] { 0, 0 };
int[] currentPosition = new int[] { 0, 0 };
int[] currentDirection = new int[] { -1, 0 };

//Orden de las direcciones (arriba, derecha, abajo, izquierda), comparte index con ocuppedPositions
int[][] directionsSort = new int[][] { new int[] { -1, 0 }, new int[] { 0, 1 }, new int[] { 1, 0 }, new int[] { 0, -1 } };

//Puzzle
List<List<string>> puzzleMap = new List<List<string>>();
foreach (string line in puzzle.Split("\r\n"))
{
    puzzleMap.Add(line.Select(x => x.ToString()).ToList());
}

//Recuerda echar para tras a la guarda para guardar también la direccion
//Localizar la posicion inicial
for (int y = 0; y < puzzleMap.Count; y++)
{
    for (int x = 0; x < puzzleMap[y].Count; x++)
    {
        if (puzzleMap[y][x] == "^")
        {
            startingPosition = new int[] { y, x };
            currentPosition = new int[] { y, x };
            break;
        }
    }
}

Boolean isEnd = false;
//Los muros invisibles
List<string> fakeWalls = new List<string>();
currentDirection = directionsSort[0];
while (!isEnd)
{
    try
    {
        //Comprobar si la dirección es válida
        Boolean canMove = false;
        while (!canMove)
        {
            int[] nextPosition = new int[] { currentPosition[0] + currentDirection[0], currentPosition[1] + currentDirection[1] };
            //Comprobar
            if (puzzleMap[nextPosition[0]][nextPosition[1]] == "#")
            {
                //Girar a la derecha
                currentDirection = directionsSort[(Array.IndexOf(directionsSort, currentDirection) + 1) % 4];
            }
            else
            {
                canMove = true;
            }
        }
        //Guardar


        //Comprobar si la siguiente posición existe
        try
        {
            int[] nextPosition = new int[] { currentPosition[0] + currentDirection[0], currentPosition[1] + currentDirection[1] };
            if (puzzleMap[nextPosition[0]][nextPosition[1]] == ".")
            {
                if(Guarda.GeneraBucle(startingPosition, directionsSort[0], nextPosition, puzzleMap))
                {
                    if (startingPosition[0] != nextPosition[0] || startingPosition[1] != nextPosition[1])
                    {
                        if (!fakeWalls.Contains($"{nextPosition[0]},{nextPosition[1]}"))
                        {
                            fakeWalls.Add($"{nextPosition[0]},{nextPosition[1]}");
                        }
                    }
                }
                
            }
        }
        catch (Exception e) 
        {
        }

        //Mover
        currentPosition[0] += currentDirection[0];
        currentPosition[1] += currentDirection[1];

    }//Controlar si se sale del mapa
    catch (Exception e)
    {
        isEnd = true;
    }
}

Console.WriteLine(fakeWalls.Count);